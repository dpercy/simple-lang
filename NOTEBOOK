
Current most pressing need with the notebook UI:

line numbers. I can't tell which outputs go with which expressions.

impl plan?

- add line numbers to read
- add line numbers to parse
- don't just print the line numbers - that would break all the tests
- don't add new "modes" to codegen

What do you generate for the module?
Different "runtime modes", where some env var determines how to print?

Or maybe the module doesn't run for side effects, but exports some interface
to run the module?


Maybe SL modules should be compiled down to a JS function.
That way the SL runtime has more control.
Also fits the philosophy of "everything is a value".

Its arguments would be the instantiated modules it depends on.
It returns an "instantiated module".
(function ({ bool, list, string }) {

  ...

  return {
    $gen_program,
    $parse_program,
    $read_all,
    ...
  }

});

ok, problems still:
- no incremental progress (YAGNI???)





backing up:
what problem am I solving?
- line numbers
- preserve incremental output
- preserve current behavior of command line tests?
  - or, is it more valuable to change the tests,
    so that line numbers get tested?

Simplest thing that works:
- add line numbers to read, parse
- gen line numbers in calls to "toplevel"
- let primitives.mjs read some global setting, on window, about how to print
